% pdf/a 
\begin{filecontents*}[overwrite]{\jobname.xmpdata}
    \Title{Önálló laboratórium 2 dolgozat}
    \Author{Szilágyi Gábor}
    \Language{hu-HU}
    \Subject{Modell-redukció alkalmazása az elektromágneses térszámításban}
    \Keywords{POD}
    \Publisher{Szilágyi Gábor}
\end{filecontents*}

\documentclass[a4paper,12pt,titlepage]{article}
\usepackage{ucs}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[magyar]{babel}
\usepackage{amsfonts}
\usepackage{amsmath,bm}
%\usepackage{amssymb}
\usepackage{graphicx}
%\usepackage[hang]{caption}
%\usepackage{subcaption}
%\usepackage{enumerate}
%\usepackage{psfrag}
\usepackage[left=20mm,right=20mm,top=20mm,bottom=25mm]{geometry}
%\usepackage[left=10mm,right=10mm,top=10mm,bottom=15mm]{geometry} %landscape
%\usepackage[hyphenbreaks]{breakurl}
%\usepackage[hyphens]{url}
%\usepackage{multirow}
%\usepackage{booktabs}
\usepackage{hyperref}
%\usepackage{listings}
%\usepackage{cite}
%\usepackage{csquotes}
%\usepackage[range-phrase=--, range-units=single]{siunitx}
\usepackage{xcolor}
\usepackage[a-3u]{pdfx}
\hypersetup{
	colorlinks,
%	linkcolor={red!50!black},
	linkcolor={black},
%	citecolor={blue!50!black},
	citecolor={black},
%	urlcolor={blue!80!black}
	urlcolor={blue!80!black}
}

\pagestyle{plain} 

\listfiles % a package-ek kilistázása a logba

\title{
    \centering
    \includegraphics[width=0.6\textwidth]{kep/bme_logo.pdf} \\
    \vspace{0.5cm}
    \large{\bf Budapesti Műszaki és Gazdaságtudományi Egyetem \\
    Villamosmérnöki és Informatikai Kar \\
    Szélessávú Hírközlés és Villamosságtan Tanszék}\\
    \vspace{4cm}
    \large{Önálló laboratórium 2 dolgozat} \\
    \vspace{2cm}
    \Large{\bf{Modell-redukció alkalmazása az elektromágneses térszámításban}} \\
    \vspace{2cm}
}

%\parskip=10pt
%\parindent=0pt

\newcommand\adj[1]{#1^{\mathrm{H}}}

\author{Szilágyi Gábor \\\vspace{2cm}\\ Konzulens: Dr. Bilicz Sándor}
\date{Budapest, \today}


\begin{document}
    \maketitle
    \tableofcontents
    \section{Bevezetés}
            A POD, vagyis a Proper Orthogonal Decomposition, egy bázistranszformációs eljárás, ami egy adott adathalmaz reprezentálásához optimális bázist keres meg. Az eljárás által meghatározott $\Psi$ bázisban a bázisvektoroknak az a tulajdonsága, hogy a lehető legkevesebb bázisvektorral leírható az adathalmaz információtartalmának vagy energiájának lehető legnagyobb része. Ezt felhasználva a $\Psi$ csonkításával egy közelítő bázist lehet előállítani ($\Psi'$), ami lényegesen kisebb rendű, mint $\Psi$, mégis kis hibával reprezentálható benne az eredeti adathalmaz. Természetesen minél több bázisvektort hagyunk meg $\Psi'$-ben, annál jobban csökken a modell-redukcióból származó hiba, de a csonkítás mértékét az adott alkalmazáshoz mérten előírhatjuk. A POD egy másik előnyös tulajdonsága, hogy a gyakorlati esetek nagy részében a sorbarendezett $\psi_n$ bázisvektorokra eső energiatartalom rohamosan csökken, ezért sokszor nagyságrendekkel kisebb dimenziószámú bázissal is jól leírható az adathalmaz, mint az eredeti esetben.
		\subsection{A módszer eredete}
            A POD eredete szorosan kapcsolódik a turbulens áramlások tanulmányozásához, szimulációjához, ami egy hírhedten nehezen megfogható probléma. A módszer gyökerei az 1930-as, '40-es évekig nyúlnak vissza, amikor olyan tudományos problémákat próbáltak statisztikai módszerekkel megközelíteni, amelyeknek a megoldása valamilyen folytonos értékű függvény, sok esetben sztochasztikus folyamat. Egy jeles személy ebből a kezdeti időszakból Kosambi \cite{Kosambi}. Sikeresen alkalmaz években született turbulens áramlások szimulációja kapcsán \cite{Sirovich}, amellyel a Method of Snapshots néven találkozhatunk.

			 % Narasimha, R. Kosambi and proper orthogonal decomposition. Reson 16, 574–581 (2011). https://doi.org/10.1007/s12045-011-0062-8
        \subsection{Felhasználási területek}
            Az eljárást számos tudományterületen sikeresen alkalmazták már, különböző területeken különböző néven szokták emlegetni gyakorlatilag ugyanezt az eljárást. Statisztikában főként Principal Component Analysis (PCA) néven fordul elő és nagy adathalmazok információtartalmának kinyerésére használják. Találkozhatunk még vele az irodalomban Karhunen–Lo\`eve Expansion néven is. A turbulens áramlások kutatásával kapcsolatban pedig Method of Snapshots néven is ismert az 1980-as évektől \cite{Sirovich}.
            % PCA-hoz:      Jolliffe Ian T. and Cadima Jorge 2016Principal component analysis: a review and recent developmentsPhil. Trans. R. Soc. A.3742015020220150202 http://doi.org/10.1098/rsta.2015.0202
            \par
            Ezeknél a problémáknál az okozza általában a fő gondot, hogy a szimulált rendszer szabadsági fokainak száma nagyon nagy, emiatt egy-egy szimuláció nagyon sok ideig tart, pontatlanabb diszkretizált modell pedig fals eredményekre vezet. Nagy adathalmazok redukálása esetén pedig lényeges, kezelhető méretű információtartalom kinyerésée szolgál. Lényeges felhasználási területek például: turbulens áramlások szimulációja; statisztikában és más területeken az adathalmazok redukálása; szabályozástechnikában a szuboptimális, de gyorsan számítható beavatkozás; nemlineáris elektromágneses problémák (pl. motorok) szimulációja.
        \subsection{Alkalmazás az elektromágneses térszámításban}
            \label{sec:empod}
            Az EM térszámításban többféle kontextusban is hasznos lehet a POD a futási idő  vagy a memóriafelhasználás jelentős csökkentésére. Az egyik megközelítésben egy végeselem modellben zajló tranziens folyamat lefolyására kaphatunk számítás szempontjából olcsó, közelítő megoldást. Ehhez először a teljes kérdéses időintervallum első töredék részére egy teljes értékű szimulációt futtatunk, amely viszonylag sok számítást igényel. Ennek a rövid részmegoldásnak az eredményei szolgálnak a POD bemenetéüli. A POD ezek alapján meghatározza a rendszer dinamikájában megjelenő struktúrákat, majd csak a lényeges összetevőkre szorítkozva egy lecsökkentett szabadsági fokú rendszert szimulálunk tovább a hátralévő időben, ami már időlépésenként sokkal kevesebb számítást igényel.             \par
            A fent vázolt, tranziens szimulációban történő alkalmazáson kívül más módokon is hasznosítható lehet a POD a térszámítási problémákban, de a dolgozatomban elsősorban ezzel a megközelítéssel foglalkozom.
    \section{A POD-ról részletesebben}
        A bevezetésben említettem, hogy az adathalmaz energiájának vagy információtartalmának szempontjából optimális a $\Psi$ bázis, de ez pontosításra szorul.
        \subsection{A felbontás egyenletei}
            A redukálandó adathalmaz méreteitől függően különböző számítási módok optimálisak a POD redukált bázisának előállításához. Az eredeti adathalmazt egy mátrixba rendezzük úgy, hogy az egyes mintákhoz artozó adatok vektorai (${\bf x}_i \in \mathbb{C}^n,~i \in \{1,~\hdots,~k\}$) a mátrix oszlopvektorai legyenek. Az így kapott mátrix (${\bf S}$) a snapshotmátrix vagy mintamátrix:
            \begin{align}
                {\bf S} = & \left[ {\bf x}_1~{\bf x}_2~{\bf x}_3~\hdots~{\bf x}_k \right]
            \end{align}
            Az adott alkalmazástól függ, hogy ${\bf S}$-nek melyik mérete olyan nagy, hogy az gondot jelentsen. \Aref{sec:empod}. részben vázolt nagy szabadsági fokú szimulációknál az okozza a gondot, hogy az egy időlépéshez tartozó ${\bf x}_i$ dimenziószáma -- vagyis $n$ -- nagy, könnyen milliós nagyságrendű, miközben egy jó redukált bázis előállításához, $k \ll n$ db. ${\bf x}_i$ minta elég a dinamikus rendszerből. Ebben az esetben jól használható az ${\bf S}$ sajátfelbontása (SVD-je):
            \begin{align}
                \label{equ:svd}
                {\bf S}~=&~{\bf U \Sigma \adj{V}}
            \end{align}
            Itt érdemes megállni és értelmezni a felbontásban szereplő mátrixokat és azok jelentését a modellezett rendszerrel kapcsolatban. \Aref{equ:svd}. egyenletben ${\bf U} \in \mathbb{C}^{n\times k}$ lesz a teljes $\Psi$ bázis vektorait (${\bf u}_i,~i \in \{1,~\hdots,~k\}$), mint oszlopvektorokat tartalmazó unitér mátrix, tehát az oszlopai egységvektorok. A ${\bf \Sigma} \in \mathbb{R}^{m\times m}~(m=min\{n,k\}=k)$ egy pozitív definit diagonálmátrix, aminek az $i$-eik diagonálelemei, $\sigma_i$ az ${\bf u}_i$-hez tartozó együttható, ami azt fejezi ki, hogy az adott bázisvektor mennyire fontos, mennyire járul hozzá általában a rendszer állapotához, más szóval a rendszer energiájának vagy információtartalmának mekkora része írható le az adott bázisvektorral. A ${\bf \Sigma}$ olyan felépítésű az SVD miatt, hogy a diagonálelemek csökkenő sorrendben szerepelnek az átlóban bal fentről jobbra lefelé haladva. A ${\bf U\Sigma} \in \mathbb{C}^{n\times m}$ szorzat tehát már az eredeti adatokhoz skálázott bázisvektorok mátrixának tekinthető, amelyben fontosság szerint csökkenő sorrendben szerepelnek egymás után a bázisvektorok. Tömören összefoglalva a ${\bf \adj{V}}$ mátrix a skálázott bázisvektorokhoz tartozó együtthatók mátrixa. A ${\bf \adj{V}}$ mátrix az $i$-edik ${\bf v}_i$ oszlopában tartalmazza az ${\bf x}_i$ mintavektor előállításához szükséges együtthatókat, amelyek a ${\bf U\Sigma}$ szorzat oszlopait súlyozzák:
            \begin{align}
                {\bf x}_i~=&~{\bf U\Sigma v}_i
            \end{align}
            Más szemszögből megközelítve a ${\bf \adj{V}}$ értelmezését, $v_{j,i}$, tehát ${\bf \adj{V}}$ $j$-edik sorának $i$-edik eleme (${\bf v}_i$ $j$-edik eleme) jelenti ${\bf u}_j \sigma_j$ hozzájárulását vagy súlyát ${\bf x}_i$-hez.
            \par
            Az ellenkező esetben, amikor $k$ nagy és emiatt $m=min\{n,k\}=n$, már számításigény szempontjából nem optimális ${\bf S}$ szinguláris érték szerinti felbontásának direkt kiszámolása, mert ez az immár $k \times k$ méretű ${\bf \adj{V}}$ mátrix kiszámolásával jár, ami a redukált modell létrehozása szempontjából lényegtelen. Ebben az esetben érdemesebb kiszámítani az adathalmaz kovarianciamátrixát, a ${\bf C} \in \mathbb{C}^{n \times n}$ mátrixot. Azért jutunk ezzel előrébb, mert \aref{equ:kovariancia}. egyenletben látható módon az ${\bf U}$ mátrixot megkaphatjuk a ${\bf C}$ sajátfelbontásából is. Mivel ${\bf C}$ szimmetrikus, ezért pozitív definit, emiatt mindig létezik sajátfelbontása.
            \begin{align}
            \begin{split}
                \label{equ:kovariancia}
                {\bf C}~=&~{\bf S \adj{S}} \\
                =&~{\bf U \Sigma \adj{V} V\Sigma \adj{U}} \\
                =&~{\bf U \Sigma}^2{\bf \adj{U}}
            \end{split}
            \end{align}
            Itt ${\bf S}$ a snapshot-mátrix, ${\bf U}$ oszlopai az új bázisvektorok, ${\bf \Sigma}$ tartalmazza a bázisvektorok információtartalmát jellemző szinguláris értékeket a főátlójában, ${\bf \adj{V}}$ sorai az egyes bázisvektorok időfüggő együtthatói, ${\bf C}$ pedig az ${\bf x}_i$ mintavektorokból álló adathalmaz kovarianciamátrixa.
    \section{\LaTeX~Próba}
        Lorem ipsum \cite{PGD}.
        \begin{align}
            {\bf X}~=&~{\bf V\Sigma U}^*
        \end{align}
    \bibliography{mybib}
    \bibliographystyle{plain}
\end{document}

%\cite{Henneron14}

%            \begin{figure}
%                \centering
%                \includegraphics[width=0.8\textwidth]{kep/szerkesztett/wstk-mighty-gecko-nagy.jpg}
%                \caption{WSTK + radio board.}
%                \label{fig:wstkmighty}
%            \end{figure}
% \cite{Anritsu}
%            \begin{figure}
%                \centering
%                \begin{subfigure}{0.48\textwidth}
%                    \includegraphics[width=\textwidth]{kep/szerkesztett/sol-868-conducted.png}
%                    \caption{\SI{868}{MHz}}
%                \end{subfigure}
%                \begin{subfigure}{0.48\textwidth}
%                    \includegraphics[width=\textwidth]{kep/szerkesztett/sol-470-conducted.png}
%                    \caption{\SI{470}{MHz}}
%                \end{subfigure}
%                \caption{470 és \SI{868}{MHz}-es Sol radio board-ok kimeneti spektruma.}
%                \label{fig:sol-conducted}
%            \end{figure}

